# fun-ai-studio-runtime 真实配置文件（当前按内网环境可直接提交）
#
# 说明：
# - 部署时可将本文件复制到服务器：/opt/fun-ai-studio/config/runtime.env
# - systemd 推荐用 EnvironmentFile 加载本文件，例如：
#   EnvironmentFile=/opt/fun-ai-studio/config/runtime.env
#

# Runtime-Agent（HTTP）
RUNTIME_AGENT_HOST=0.0.0.0
RUNTIME_AGENT_PORT=7005

# Runner -> Runtime-Agent 鉴权 Token（Header: X-Runtime-Token）
# 需要与 Runner 的 RUNTIME_AGENT_TOKEN 保持一致
RUNTIME_AGENT_TOKEN=8f3d1a6c9e0b4f2d7c5a1e9b6d3f0c8a2e7b4d1f9c6a3b0e5d8c2f7a1b9e4d0c

# Runtime 节点标识与对外信息（用于向 Deploy 注册）
RUNTIME_NODE_NAME=rt-node-01
RUNTIME_NODE_AGENT_BASE_URL=http://172.21.138.102:7005
# 统一公网入口（后续你按实际域名/网关替换）
RUNTIME_NODE_GATEWAY_BASE_URL=http://172.21.138.102

# Deploy 控制面（100 内网）
DEPLOY_BASE_URL=http://172.21.138.100:7002
# runtime 节点心跳 token：需要与 Deploy 的 deploy.runtime-node-registry.shared-secret 一致
DEPLOY_NODE_TOKEN=4c1d7e9a2b0f6d3c8a5e1f0b9d7c3a2e6f8b4d1a0c9e7b5f3d2a8c6e1b0f9d7a
# 心跳间隔（秒），默认 60
DEPLOY_HEARTBEAT_SECONDS=60

# 可选：Docker 网络与 Traefik
RUNTIME_DOCKER_NETWORK=funai-runtime-net
RUNTIME_TRAEFIK_ENABLE=true

# 用户容器资源限制（可选；不填则不限制）
# 建议（8C 机器起步值）：RUNTIME_APP_CPUS=1  /  RUNTIME_APP_MEMORY=2g  /  RUNTIME_APP_PIDS_LIMIT=256
#RUNTIME_APP_CPUS=1
#RUNTIME_APP_CPU_SHARES=512
#RUNTIME_APP_CPUSET_CPUS=
#RUNTIME_APP_MEMORY=2g
#RUNTIME_APP_MEMORY_SWAP=0
#RUNTIME_APP_PIDS_LIMIT=256

# 日志目录（落盘到 app.log + app.YYYY-MM-DD.i.log.gz）
FUNAI_LOG_DIR=/data/funai/logs/fun-ai-studio/fun-ai-studio-runtime
RUNTIME_DOCKER_BIN=/usr/bin/podman

# 运行态 Mongo（89）
# - 配好后，runtime-agent 会在部署用户应用容器时自动注入：
#   - MONGODB_URI / MONGO_URL
#   - FUNAI_MONGO_DB_NAME
# - dbName 默认按“用户-应用维度”生成：db_u{userId}_a{appId}（可用模板改）
RUNTIME_MONGO_HOST=172.21.138.89
RUNTIME_MONGO_PORT=27017
RUNTIME_MONGO_USERNAME=funai
RUNTIME_MONGO_PASSWORD=CHANGE_ME
RUNTIME_MONGO_AUTH_SOURCE=admin
RUNTIME_MONGO_DB_TEMPLATE=db_u{userId}_a{appId}
# best-effort 预创建数据库（写入 __funai_meta__ 一条init记录）
RUNTIME_MONGO_PRECREATE=true
RUNTIME_MONGO_PRECREATE_TIMEOUT_SECONDS=3

# 磁盘稳定优先（Runtime 单机磁盘较小场景推荐）：
# - 下线（/agent/apps/stop）也会清理该 app 的本地镜像（docker rmi -f + image prune）
# - 代价：下次部署需要重新 pull 镜像，速度会慢一些
RUNTIME_CLEANUP_IMAGES_ON_STOP=true

